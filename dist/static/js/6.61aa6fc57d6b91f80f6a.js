webpackJsonp([6],{"1A4E":function(e,t){},AWfZ:function(e,t){},ibcO:function(e,t){},ycJn:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("lC5x"),i=a.n(n),r=a("J0Oq"),s=a.n(r),o=a("GPKu"),l={components:{},mixins:[],props:["equipmentInfo"],data:function(){return{configerList:[],equTypeList:[],form:{id:this.equipmentInfo.id,type:"",name:"",configerId:"",code:"",unit:"",maxValue:0,minValue:0}}},watch:{},computed:{},created:function(){this.equipmentInfo.id&&this.queryIndexInfo()},mounted:function(){this.getEquipmentConfiger(),this.getEquTypeList()},methods:{getEquipmentConfiger:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get(e.$equApi.getEquipmentConfiger);case 2:a=t.sent,e.configerList=a.data;case 4:case"end":return t.stop()}},t,e)}))()},getEquTypeList:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get(e.$equApi.indexType);case 2:a=t.sent,e.equTypeList=a.data;case 4:case"end":return t.stop()}},t,e)}))()},cancel:function(){this.$emit("update:show",!1)},addNew:function(){var e=this;this.$refs.form.validate(function(t){t?e._addAndModifyEquipment():e.$message({showClose:!0,message:errorMsg,type:"error"})})},queryIndexInfo:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get(e.$equApi.indexDetail,{id:e.equipmentInfo.id});case 2:a=t.sent,e.form=a.data;case 4:case"end":return t.stop()}},t,e)}))()},_addAndModifyEquipment:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=null,e.equipmentInfo.id){t.next=7;break}return t.next=4,e.$http.post(e.$equApi.indexAdd,e.form);case 4:a=t.sent,t.next=10;break;case 7:return t.next=9,e.$http.post(e.$equApi.indexEdit,e.form);case 9:a=t.sent;case 10:"SUCCESS"==a.result&&(e.$emit("update:show",!1),e.$emit("refreshData"),e.$message({showClose:!0,message:"添加成功",type:"success"}));case 11:case"end":return t.stop()}},t,e)}))()}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,inline:!1,"label-width":"100px",size:"mini"}},[a("el-form-item",{attrs:{label:"设备类型:"}},[a("el-select",{staticClass:"input-search fl mr10",attrs:{placeholder:"请选择",clearable:"",size:"small"},model:{value:e.form.configerId,callback:function(t){e.$set(e.form,"configerId",t)},expression:"form.configerId"}},e._l(e.configerList,function(e){return a("el-option",{key:e.validue,attrs:{label:e.des,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"指标名称:"}},[a("el-input",{staticClass:"input-search",attrs:{clearable:"",size:"small",placeholder:"请输入"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"==typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"指标类型:"}},[a("el-select",{staticClass:"input-search fl mr10",attrs:{placeholder:"请选择",size:"small"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.equTypeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"指标编码:"}},[a("el-input",{staticClass:"input-search",attrs:{clearable:"",size:"small",placeholder:"请输入"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code","string"==typeof t?t.trim():t)},expression:"form.code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"指标单位:"}},[a("el-input",{staticClass:"input-search",attrs:{clearable:"",size:"small",placeholder:"请输入"},model:{value:e.form.unit,callback:function(t){e.$set(e.form,"unit","string"==typeof t?t.trim():t)},expression:"form.unit"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"最大值:"}},[a("el-input",{staticClass:"input-search",attrs:{clearable:"",size:"small",placeholder:"请输入"},model:{value:e.form.maxValue,callback:function(t){e.$set(e.form,"maxValue","string"==typeof t?t.trim():t)},expression:"form.maxValue"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"最小值:"}},[a("el-input",{staticClass:"input-search",attrs:{clearable:"",size:"small",placeholder:"请输入"},model:{value:e.form.minValue,callback:function(t){e.$set(e.form,"minValue","string"==typeof t?t.trim():t)},expression:"form.minValue"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer text-right pb20"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e._addAndModifyEquipment}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var c=a("C7Lr")(l,u,!1,function(e){a("ibcO")},"data-v-28f0d0d0",null).exports,m=a("a3Yh"),d=a.n(m),p=a("5YEj"),f=a.n(p),h={components:{},mixins:[],props:["equipmentInfo"],data:function(){var e;return e={queryingShowLoading:!1,form:{},typeList:[]},d()(e,"queryingShowLoading",!1),d()(e,"queryParams",{itemCode:"",equipmentId:this.equipmentInfo.deviceId,startTime:"",endTime:""}),e},watch:{},computed:{},created:function(){},mounted:function(){this.queryEquipmentInfo(),this.queryEquTypeList(),this.equHistoryCharts()},methods:{cancel:function(){this.$emit("update:show",!1)},queryClick:function(){this.queryingShowLoading=!0,this.equHistoryCharts()},queryEquipmentInfo:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get(e.$equApi.queryEquipmentInfo,{equipmentId:e.equipmentInfo.deviceId});case 2:a=t.sent,e.form=a.data;case 4:case"end":return t.stop()}},t,e)}))()},queryEquTypeList:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get(e.$equApi.findEquipmentModleItem,{typeCode:e.equipmentInfo.deviceTypeMini});case 2:a=t.sent,e.typeList=a.data;case 4:case"end":return t.stop()}},t,e)}))()},equHistoryCharts:function(){var e=this;return s()(i.a.mark(function t(){var a,n,r,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e,a=document.getElementById("equHistory"),n=[],r=[],t.next=6,e.$http.post(e.$equApi.findEquipmentItemHistory,e.queryParams);case 6:(s=t.sent).data.forEach(function(e){n.push(Object(o.c)("yyyy-MM-dd hh:mm:ss",new Date(e.time))),r.push(e.value)}),e._renderLineCharts(a,n,r),s&&(e.queryingShowLoading=!1);case 10:case"end":return t.stop()}},t,e)}))()},_renderLineCharts:function(e,t,a){var n=f.a.init(e),i={grid:{top:"10px",left:"10px",right:"4%",bottom:"3%",containLabel:!0},tooltip:{show:!0,trigger:"axis"},xAxis:{type:"category",axisLine:{lineStyle:{color:"#ddd"}},axisLabel:{color:"#333",fontSize:10},data:t.map(function(e){return e.replace(" ","\n")})},yAxis:{type:"value",axisLine:{lineStyle:{color:"#ddd"}},axisLabel:{show:!0,color:"#333",fontSize:10},splitLine:{show:!1}},series:[{data:a,type:"line"}]};n.setOption(i)}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,inline:!0,"label-width":"100px",size:"mini"}},[a("el-form-item",{attrs:{label:"设备名称:"}},[a("span",[e._v(e._s(e.form.deviceName))])]),e._v(" "),a("el-form-item",{attrs:{label:"设备编码:"}},[a("span",[e._v(e._s(e.form.deviceQRCode))])]),e._v(" "),a("el-form-item",{attrs:{label:"通信编号:"}},[a("span",[e._v(e._s(e.form.letterCode))])]),e._v(" "),a("el-form-item",{attrs:{label:"生产商:"}},[a("span",[e._v(e._s(e.form.proComName))])]),e._v(" "),a("el-form-item",{attrs:{label:"厂家编码:"}},[a("span",[e._v(e._s(e.form.proComCode))])]),e._v(" "),a("el-form-item",{attrs:{label:"产品类型:"}},[a("span",[e._v(e._s(e.form.proType))])]),e._v(" "),a("el-form-item",{attrs:{label:"最小值:"}},[a("span",[e._v(e._s(e.form.minValue))])]),e._v(" "),a("el-form-item",{attrs:{label:"最大值:"}},[a("span",[e._v(e._s(e.form.maxValue))])]),e._v(" "),a("el-form-item",{attrs:{label:"通信协议:"}},[a("span",[e._v(e._s(e.form.letterAgreement))])]),e._v(" "),a("el-form-item",{attrs:{label:"传输方式:"}},[a("span",[e._v(e._s(e.form.traMethod))])]),e._v(" "),a("el-form-item",{attrs:{label:"是否模拟:"}},[a("span",[e._v(e._s(e.form.isSimulate))])]),e._v(" "),a("el-form-item",{attrs:{label:"版本号:"}},[a("span",[e._v(e._s(e.form.version))])]),e._v(" "),a("el-form-item",{attrs:{label:"巡检频次:"}},[a("span",[e._v(e._s(e.form.insFrequency))])]),e._v(" "),a("el-form-item",{attrs:{label:"过保时间:"}},[a("span",[e._v(e._s(e.form.overTime))])]),e._v(" "),a("el-form-item",{attrs:{label:"消防设施:"}},[a("span",[e._v(e._s(e.form.fireFacility))])])],1),e._v(" "),a("div",[a("div",{staticClass:"charts-head text-right"},[a("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:e.queryParams.itemCode,callback:function(t){e.$set(e.queryParams,"itemCode",t)},expression:"queryParams.itemCode"}},e._l(e.typeList,function(e){return a("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}),1),e._v(" "),a("el-date-picker",{staticClass:"school-manage-date",attrs:{type:"date",placeholder:"开始日期",size:"small",format:"yyyy-MM-dd",editable:!1,"value-format":"yyyy-MM-dd"},model:{value:e.queryParams.startTime,callback:function(t){e.$set(e.queryParams,"startTime",t)},expression:"queryParams.startTime"}}),e._v(" "),a("el-date-picker",{staticClass:"school-manage-date",attrs:{type:"date",placeholder:"结束日期",size:"small",editable:!1,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.queryParams.endTime,callback:function(t){e.$set(e.queryParams,"endTime",t)},expression:"queryParams.endTime"}}),e._v(" "),a("el-button",{staticClass:"button-query",attrs:{type:"primary",loading:e.queryingShowLoading,size:"small"},on:{click:e.queryClick}},[e._v("查询")])],1),e._v(" "),a("div",{attrs:{id:"equHistory"}})]),e._v(" "),a("div",{staticClass:"dialog-footer text-right pb20"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.cancel}},[e._v("关 闭")])],1)],1)},staticRenderFns:[]};var y=a("C7Lr")(h,v,!1,function(e){a("AWfZ")},"data-v-15bc9d91",null).exports,g=(a("dkUZ"),a("Q0Ca"),{components:{dialogAdd:c,dialogView:y},props:[],data:function(){return{dialogAdd:!1,dialogView:!1,queryingShowLoading:!1,importingShowLoading:!1,uploadAndDownload:!1,uploadType:"nbSmoke",configerList:[],equList:[],queryParams:{configerId:"",name:"",pageSize:10,pageNumber:1},token:"",total:0,pageSize:10,currentPage:1,multipleSelection:[],pickerOptions1:{disabledDate:function(e){return e.getTime()>Date.now()}},tHead:[{prop:"equipTypeName",label:"设备类别",width:""},{prop:"name",label:"指标名称",width:""},{prop:"code",label:"编码",width:""},{prop:"typeName",label:"指标类型",width:"",formatter:function(e,t,a){return a}},{prop:"unit",label:"单位",width:""},{prop:"maxValue",label:"最大值",width:""},{prop:"minValue",label:"最小值",width:""}],tBody:[],equipmentInfo:{}}},watch:{},computed:{templateURL:function(){return this.$equApi.importDevice},editShow:function(){return this.$permissionShow("equipment_edit")}},created:function(){},mounted:function(){this.token=Object(o.g)("_TOKEN_"),this.getEquipmentConfiger(),this.queryEquipmentList()},methods:{onQuery:function(){this.queryParams.pageNumber=1,this.queryEquipmentList()},addNew:function(){this.equipmentInfo={},this.dialogAdd=!0},getEquipmentConfiger:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get(e.$equApi.getEquipmentConfiger);case 2:a=t.sent,e.configerList=a.data;case 4:case"end":return t.stop()}},t,e)}))()},deleteEquipment:function(){var e=this;return s()(i.a.mark(function t(){var a,n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=[],!(e.multipleSelection.length<=0)){t.next=5;break}return t.abrupt("return");case 5:e.multipleSelection.forEach(function(e){a.push(e.id)});case 6:return t.next=8,e.$http.post(e.$equApi.indexDelete,a);case 8:"SUCCESS"==(n=t.sent).result?(e.$message({showClose:!0,message:"删除成功",type:"success"}),e.multipleSelection=[],e.onQuery()):e.$message({showClose:!0,message:n.message,type:"error"});case 10:case"end":return t.stop()}},t,e)}))()},_checkSchoolInfo:function(e){this.equipmentInfo=e,this.dialogView=!0},beforeUpload:function(e){this.token=Object(o.g)("_TOKEN_"),this.importingShowLoading=!0},uploadSuccess:function(e){var t=this;return this.importingShowLoading=!1,function(e,a,n){"SUCCESS"==e.result?(t.$message({showClose:!0,message:"导入成功",type:"success"}),t.uploadAndDownload=!1,t.refreshData()):t.$message({showClose:!0,message:"导入失败",type:"error"})}},uploadFailure:function(e,t,a){this.importingShowLoading=!1,this.$message({showClose:!0,message:"导入失败",type:"error"})},handleCurrentChange:function(e){this.queryParams.pageNumber=e,this.queryEquipmentList()},queryEquipmentList:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post(e.$equApi.indexList,e.queryParams);case 2:a=t.sent,e.tBody=a.data.content,e.total=parseInt(a.data.totalElements);case 5:case"end":return t.stop()}},t,e)}))()},_editSchoolInfo:function(e){this.equipmentInfo=e,this.dialogAdd=!0},handleSelectionChange:function(e){this.multipleSelection=e},refreshData:function(){this.onQuery()}}}),b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{inline:!0,model:e.queryParams,size:"small"}},[a("el-form-item",{attrs:{label:"指标类型:",prop:"name"}},[a("el-select",{staticClass:"input-search fl mr10",attrs:{placeholder:"请选择",clearable:"",size:"small"},model:{value:e.queryParams.configerId,callback:function(t){e.$set(e.queryParams,"configerId",t)},expression:"queryParams.configerId"}},e._l(e.configerList,function(e){return a("el-option",{key:e.validue,attrs:{label:e.des,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"指标名称:",prop:"name"}},[a("el-input",{staticClass:"input-search",attrs:{clearable:"",size:"small",placeholder:"请输入"},model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name","string"==typeof t?t.trim():t)},expression:"queryParams.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticClass:"button-query",attrs:{type:"primary",loading:e.queryingShowLoading},on:{click:e.onQuery}},[e._v("查询\n\t\t\t\t")])],1)],1),e._v(" "),a("div",{staticClass:"use-table"},[a("div",{staticClass:"clear-fix mb10"},[this.$permissionShow("equipment_create")?a("el-button",{staticClass:"button-query fr",attrs:{type:"primary",size:"small"},on:{click:e.addNew}},[e._v("新增")]):e._e(),e._v(" "),this.$permissionShow("equipment_delete")?a("el-button",{staticClass:"button-query fr mr10",attrs:{type:"warning",size:"small"},on:{click:e.deleteEquipment}},[e._v("删除\n\t\t\t\t")]):e._e()],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tBody,border:"",size:"small"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),e._l(e.tHead,function(e){return a("el-table-column",{key:e.prop,attrs:{align:"center",prop:e.prop,label:e.label,width:e.width,formatter:e.formatter}})}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e.editShow?a("el-tooltip",{attrs:{effect:"dark",content:"编辑",placement:"bottom"}},[a("el-button",{staticClass:"iconfont icon-biji",attrs:{type:"text"},on:{click:function(a){e._editSchoolInfo(t.row)}}})],1):e._e()]}}])})],2),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],staticClass:"page",attrs:{"current-page":e.queryParams.pageNumber,"page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.total,disabled:e.queryingShowLoading},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),e.dialogAdd?a("el-dialog",{attrs:{title:e.equipmentInfo.id?"编辑":"新增",visible:e.dialogAdd,width:"60%"},on:{"update:visible":function(t){e.dialogAdd=t}}},[a("dialogAdd",{attrs:{show:e.dialogAdd,equipmentInfo:e.equipmentInfo},on:{"update:show":function(t){e.dialogAdd=t},refreshData:e.refreshData}})],1):e._e(),e._v(" "),e.dialogView?a("el-dialog",{attrs:{title:"查看",visible:e.dialogView,width:"60%"},on:{"update:visible":function(t){e.dialogView=t}}},[a("dialogView",{attrs:{show:e.dialogView,equipmentInfo:e.equipmentInfo},on:{"update:show":function(t){e.dialogView=t}}})],1):e._e(),e._v(" "),e.uploadAndDownload?a("el-dialog",{attrs:{title:"上传与下载",visible:e.uploadAndDownload,width:"60%"},on:{"update:visible":function(t){e.uploadAndDownload=t}}},[a("div",{staticClass:"clearfix mt10 mb10 pl30"},[a("el-select",{staticClass:"fl mr10",staticStyle:{width:"50%"},attrs:{placeholder:"请选择",size:"small"},model:{value:e.uploadType,callback:function(t){e.uploadType=t},expression:"uploadType"}},e._l(this.$constants.equType,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1),e._v(" "),a("el-button",{staticClass:"button-query fl mr10",attrs:{size:"small",loading:e.importingShowLoading,type:"primary"},on:{click:e.downloadEquTemplate}},[e._v("下载模板\n                ")]),e._v(" "),a("el-upload",{staticClass:"button-query fl",attrs:{action:e.templateURL,headers:{"X-Access-Token":e.token},data:{deviceName:e.uploadType},"on-success":e.uploadSuccess(),"on-error":e.uploadFailure,"before-upload":e.beforeUpload,disabled:e.importingShowLoading,"show-file-list":!1}},[a("el-button",{staticClass:"button-query",attrs:{size:"small",loading:e.importingShowLoading,type:"success"}},[e._v("导入设备\n                    ")])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.uploadAndDownload=!1}}},[e._v("关闭")])],1)]):e._e()],1)},staticRenderFns:[]};var q=a("C7Lr")(g,b,!1,function(e){a("1A4E")},"data-v-447c8186",null);t.default=q.exports}});